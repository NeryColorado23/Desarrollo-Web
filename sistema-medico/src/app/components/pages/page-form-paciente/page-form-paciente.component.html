<div class="registro-paciente-container">
  <div class="header">
    <h2>Registro de Paciente</h2>
    <p>Complete todos los campos para registrar un nuevo paciente</p>
  </div>

  <form [formGroup]="pacienteForm" (ngSubmit)="onSubmit()" class="paciente-form">

    <!-- Datos Personales -->
    <mat-card class="form-section">
      <mat-card-header>
        <mat-card-title>Datos Personales</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="form-row">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Nombre Completo</mat-label>
            <input matInput formControlName="nombreCompleto" placeholder="Ingrese el nombre completo">
            @if (pacienteForm.get('nombreCompleto')?.hasError('required')) {
              <mat-error>El nombre es requerido</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Cédula/DNI</mat-label>
            <input matInput formControlName="cedula" placeholder="Número de identificación">
            <mat-error *ngIf="pacienteForm.get('cedula')?.hasError('required')">
              La cédula es requerida
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Fecha de Nacimiento</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="fechaNacimiento">
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="pacienteForm.get('fechaNacimiento')?.hasError('required')">
              La fecha de nacimiento es requerida
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Género</mat-label>
            <mat-select formControlName="genero">
              <mat-option value="masculino">Masculino</mat-option>
              <mat-option value="femenino">Femenino</mat-option>
              <mat-option value="otro">Otro</mat-option>
            </mat-select>
            <mat-error *ngIf="pacienteForm.get('genero')?.hasError('required')">
              Seleccione un género
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Teléfono</mat-label>
            <input matInput formControlName="telefono" placeholder="Número de teléfono">
            <mat-error *ngIf="pacienteForm.get('telefono')?.hasError('required')">
              El teléfono es requerido
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" placeholder="correo@ejemplo.com">
            <mat-error *ngIf="pacienteForm.get('email')?.hasError('required')">
              El email es requerido
            </mat-error>
            <mat-error *ngIf="pacienteForm.get('email')?.hasError('email')">
              Ingrese un email válido
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Dirección</mat-label>
            <textarea matInput formControlName="direccion" rows="2" placeholder="Dirección completa"></textarea>
            <mat-error *ngIf="pacienteForm.get('direccion')?.hasError('required')">
              La dirección es requerida
            </mat-error>
          </mat-form-field>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Signos Vitales -->
    <mat-card class="form-section">
      <mat-card-header>
        <mat-card-title>Signos Vitales</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="form-row">
          <mat-form-field appearance="fill" class="quarter-width">
            <mat-label>Temperatura (°C)</mat-label>
            <input matInput type="number" formControlName="temperatura" step="0.1" placeholder="36.5">
          </mat-form-field>

          <mat-form-field appearance="fill" class="quarter-width">
            <mat-label>Peso (kg)</mat-label>
            <input matInput type="number" formControlName="peso" step="0.1" placeholder="70.0">
          </mat-form-field>

          <mat-form-field appearance="fill" class="quarter-width">
            <mat-label>Altura (cm)</mat-label>
            <input matInput type="number" formControlName="altura" placeholder="170">
          </mat-form-field>

          <mat-form-field appearance="fill" class="quarter-width">
            <mat-label>IMC</mat-label>
            <input matInput type="number" [value]="calcularIMC()" readonly>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Presión Sistólica (mmHg)</mat-label>
            <input matInput type="number" formControlName="presionSistolica" placeholder="120">
          </mat-form-field>

          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Presión Diastólica (mmHg)</mat-label>
            <input matInput type="number" formControlName="presionDiastolica" placeholder="80">
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Frecuencia Cardíaca (bpm)</mat-label>
            <input matInput type="number" formControlName="frecuenciaCardiaca" placeholder="72">
          </mat-form-field>

          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Frecuencia Respiratoria (rpm)</mat-label>
            <input matInput type="number" formControlName="frecuenciaRespiratoria" placeholder="16">
          </mat-form-field>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Motivo de Consulta -->
    <mat-card class="form-section">
      <mat-card-header>
        <mat-card-title>Motivo de Consulta</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="form-row">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Describe el motivo de la consulta</mat-label>
            <textarea matInput formControlName="motivoConsulta" rows="4"
                      placeholder="Describa los síntomas, molestias o motivo por el cual consulta..."></textarea>
            <mat-error *ngIf="pacienteForm.get('motivoConsulta')?.hasError('required')">
              El motivo de consulta es requerido
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Síntomas Adicionales</mat-label>
            <textarea matInput formControlName="sintomasAdicionales" rows="3"
                      placeholder="Otros síntomas o información relevante (opcional)"></textarea>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Tipo de Consulta</mat-label>
            <mat-select formControlName="tipoConsulta">
              <mat-option value="primera-vez">Primera vez</mat-option>
              <mat-option value="control">Control</mat-option>
              <mat-option value="urgencia">Urgencia</mat-option>
              <mat-option value="emergencia">Emergencia</mat-option>
            </mat-select>
            <mat-error *ngIf="pacienteForm.get('tipoConsulta')?.hasError('required')">
              Seleccione el tipo de consulta
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="half-width">
            <mat-label>Prioridad</mat-label>
            <mat-select formControlName="prioridad">
              <mat-option value="baja">Baja</mat-option>
              <mat-option value="media">Media</mat-option>
              <mat-option value="alta">Alta</mat-option>
              <mat-option value="critica">Crítica</mat-option>
            </mat-select>
            <mat-error *ngIf="pacienteForm.get('prioridad')?.hasError('required')">
              Seleccione la prioridad
            </mat-error>
          </mat-form-field>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Botones de Acción -->
    <div class="form-actions">
      <button mat-raised-button type="button" color="accent" [routerLink]="['/']">
        Cancelar
      </button>
      <button mat-raised-button type="submit" color="primary" [disabled]="!pacienteForm.valid">
        Registrar Paciente
      </button>
    </div>
  </form>

  <!-- Botón para regresar al inicio -->
  <div class="boton-regreso-container">
    <button mat-stroked-button [routerLink]="['/']" class="boton-regreso">
      Regresar al Inicio
    </button>
  </div>

  <!-- Mensaje de éxito -->
  <div *ngIf="mensajeExito" class="mensaje-exito">
    <mat-icon>check_circle</mat-icon>
    <span>{{ mensajeExito }}</span>
  </div>
</div>
